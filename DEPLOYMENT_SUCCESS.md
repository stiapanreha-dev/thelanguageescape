# ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

## üéâ –°—Ç–∞—Ç—É—Å: –†–ê–ë–û–¢–ê–ï–¢

–î–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: **2025-10-23**

---

## üìä –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### GitHub Actions Workflow

‚úÖ **–§–∞–π–ª:** `.github/workflows/deploy.yml`
‚úÖ **Action:** `appleboy/ssh-action@v1.0.0`
‚úÖ **–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ `git push` –≤ –≤–µ—Ç–∫—É `main`
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub UI (workflow_dispatch)

### GitHub Secrets

–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —á–µ—Ä–µ–∑ `gh secret set`:

| Secret | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|--------|----------|--------|
| `SSH_PRIVATE_KEY` | RSA –∫–ª—é—á (4096 –±–∏—Ç) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `VPS_HOST` | d2305931f6ab.vps.myjino.ru | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `VPS_PORT` | 49311 | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `VPS_USER` | root | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `PROJECT_DIR` | /root/language_escape_bot | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (–ø—Ä–∏ push)

```bash
# 1. –î–µ–ª–∞–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
git add .
git commit -m "–≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
git push origin main

# 2. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ VPS
# ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç git pull
# ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
# ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞
# ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (—á–µ—Ä–µ–∑ CLI)

```bash
gh workflow run deploy.yml
gh run watch  # —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (—á–µ—Ä–µ–∑ GitHub UI)

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/stiapanreha-dev/thelanguageescape/actions
2. –í—ã–±–µ—Ä–∏—Ç–µ **Deploy to VPS**
3. –ù–∞–∂–º–∏—Ç–µ **Run workflow** ‚Üí **Run workflow**

---

## üìù –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ:

```bash
üöÄ Starting deployment...
üì• Pulling latest code from GitHub...
üêç Activating virtual environment...
üì¶ Installing dependencies...
üîÑ Restarting bot service...
‚úÖ Checking service status...
‚úÖ Bot is running successfully
üéâ Deployment complete!
```

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç **~15-20 —Å–µ–∫—É–Ω–¥**.

---

## üîç –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –¥–µ–ø–ª–æ—è

### –ß–µ—Ä–µ–∑ GitHub CLI

```bash
# –°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤
gh run list --limit 5

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
gh run view <run_id> --log

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
gh run view <run_id> --log-failed

# –°–ª–µ–¥–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
gh run watch <run_id>
```

### –ß–µ—Ä–µ–∑ GitHub UI

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/stiapanreha-dev/thelanguageescape/actions
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –∑–∞–ø—É—Å–∫
3. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —à–∞–≥–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π

---

## ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫

**Run ID:** 18758020474

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Deploy Bot to VPS in 20s
  ‚úÖ Set up job
  ‚úÖ Build appleboy/ssh-action@v1.0.0
  ‚úÖ Checkout code
  ‚úÖ Deploy to VPS via SSH
  ‚úÖ Send notification on success
  ‚úÖ Complete job
```

**–õ–æ–≥:**
```
üöÄ Starting deployment...
üì• Pulling latest code from GitHub...
‚úÖ Checking service status...
‚úÖ Bot is running successfully
üéâ Deployment complete!
‚úÖ Successfully executed commands to all host.
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### SSH –ö–ª—é—á–∏

- ‚úÖ –°–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π RSA –∫–ª—é—á –¥–ª—è GitHub Actions
- ‚úÖ –ö–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ GitHub Secrets (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω)
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `~/.ssh/authorized_keys` –Ω–∞ VPS
- ‚úÖ –§–æ—Ä–º–∞—Ç: RSA 4096 –±–∏—Ç (—Å–æ–≤–º–µ—Å—Ç–∏–º —Å appleboy/ssh-action)

### –§–∞–π–ª—ã –Ω–∞ VPS

```
~/.ssh/
‚îú‚îÄ‚îÄ id_rsa              # –û—Å–Ω–æ–≤–Ω–æ–π ed25519 –∫–ª—é—á (–¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
‚îú‚îÄ‚îÄ id_rsa.pub
‚îú‚îÄ‚îÄ id_rsa_github       # RSA –∫–ª—é—á –¥–ª—è GitHub Actions
‚îú‚îÄ‚îÄ id_rsa_github.pub
‚îî‚îÄ‚îÄ authorized_keys     # –°–æ–¥–µ—Ä–∂–∏—Ç –æ–±–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–∞
```

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î–µ–ø–ª–æ–π –∑–∞–≤–∏—Å

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å workflow
gh run list --limit 1

# –û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∑–∞–ø—É—Å–∫
gh run cancel <run_id>

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
gh workflow run deploy.yml
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: SSH –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
# –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ VPS
ssh -p 49311 root@d2305931f6ab.vps.myjino.ru 'cat ~/.ssh/authorized_keys | grep github-actions'

# –ï—Å–ª–∏ –∫–ª—é—á–∞ –Ω–µ—Ç, –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω–æ–≤–æ:
ssh -p 49311 root@d2305931f6ab.vps.myjino.ru 'cat ~/.ssh/id_rsa_github.pub >> ~/.ssh/authorized_keys'
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS
ssh -p 49311 root@d2305931f6ab.vps.myjino.ru

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status language-escape-bot

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
journalctl -u language-escape-bot -n 50
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

| –î–µ–π—Å—Ç–≤–∏–µ | –î–æ (—Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π) | –ü–æ—Å–ª–µ (GitHub Actions) |
|----------|-------------------|----------------------|
| SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | –í—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| git pull | –í—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| pip install | –í—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| systemctl restart | –í—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ | –í—Ä—É—á–Ω—É—é | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –õ–æ–≥–∏ –¥–µ–ø–ª–æ—è | –ù–µ—Ç | ‚úÖ –ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –≤ GitHub |
| –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è | 2-3 –º–∏–Ω—É—Ç—ã | ~20 —Å–µ–∫—É–Ω–¥ |
| –†–∏—Å–∫ –æ—à–∏–±–∫–∏ | –í—ã—Å–æ–∫–∏–π | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π |
| –ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å | –ù–∏–∑–∫–∞—è | 100% |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.github/workflows/deploy.yml`:

```yaml
- name: Send notification on success
  if: success()
  run: |
    curl -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
      -d "chat_id=${{ secrets.ADMIN_TELEGRAM_ID }}" \
      -d "text=‚úÖ –î–µ–ø–ª–æ–π —É—Å–ø–µ—à–µ–Ω! –ë–æ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç."
```

### 2. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: |
          python -m pytest tests/

  deploy:
    needs: test
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π deploy job
```

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É `develop` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–¥ production.

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **GitHub Actions:** https://github.com/stiapanreha-dev/thelanguageescape/actions
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/stiapanreha-dev/thelanguageescape
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è appleboy/ssh-action:** https://github.com/appleboy/ssh-action

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-10-23
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready
**–ü–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—à–Ω—ã–π –¥–µ–ø–ª–æ–π:** Run #18758020474

üéâ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!**
